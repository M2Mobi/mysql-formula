# DO NOT CHANGE THIS FILE!
# This config is generated by SALTSTACK
# and all change will be overrided on next salt call

{%- from "mysql/defaults.yaml" import rawmap with context -%}
{%- set mysql = salt['grains.filter_by'](rawmap, grain='os', merge=salt['pillar.get']('mysql')) -%}
{%- set auth = { 'socket': False } -%}

{%- if mysql.server.root_unix_socket is defined and mysql.server.root_unix_socket != None -%}
  {%- do auth.update({'socket': True}) -%}
{%- endif -%}

{%- if mysql.user is defined -%}
  {%- for name, user in mysql.user.items() -%}
    {%- if user['unix_socket'] is defined and user['unix_socket'] == True -%}
      {%- do auth.update({'socket': True}) -%}
    {%- endif -%}
  {%- endfor -%}
{%- endif -%}

{%- if auth.socket == True %}
[mysqld]
plugin-load                      = auth_socket
{%- endif %}
